var e=Object.defineProperty,t=(t,n,r)=>((t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r)(t,"symbol"!=typeof n?n+"":n,r);!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="dd9a655a-2c97-46bf-a155-4a0cbf554d0a",e._sentryDebugIdIdentifier="sentry-dbid-dd9a655a-2c97-46bf-a155-4a0cbf554d0a")}catch(n){}}();import{s as n,n as r,E as a,a as o,c as s}from"./index-zDGX7_eg.js";import"./_sentry-release-injection-file-BetQGEEZ.js";import{m as l}from"./messenger-Bd6yZOQZ.js";import{i as c}from"./init-sQey_HaX.js";import"./types-Oyjdt06n.js";class u{constructor(e){t(this,"result"),this.result=e}get singleNodeValue(){const e=this.result.singleNodeValue;return e?new i(e):null}get snapshotLength(){return this.result.snapshotLength}snapshotItem(e){const t=this.result.snapshotItem(e);return t?new i(t):null}get stringValue(){return this.result.stringValue}}class i{constructor(e){t(this,"node"),this.node=e}get textContent(){return this.node.textContent}evaluate(e,t){return new u(document.evaluate(e,this.node,null,t,null))}querySelectorAll(e){return this.node instanceof Element?Array.from(this.node.querySelectorAll(e)).map((e=>new i(e))):[]}getUnderlyingNode(){return this.node}}class d{constructor(){t(this,"ORDERED_NODE_SNAPSHOT_TYPE",XPathResult.ORDERED_NODE_SNAPSHOT_TYPE),t(this,"FIRST_ORDERED_NODE_TYPE",XPathResult.FIRST_ORDERED_NODE_TYPE),t(this,"STRING_TYPE",XPathResult.STRING_TYPE)}cleanup(){}waitForPageLoad(){return new Promise((e=>{"complete"===document.readyState?e():window.addEventListener("load",(()=>e()))}))}getDocument(){return new i(document)}getDocumentElement(){return new i(document.documentElement)}extractHtml(){return document.documentElement.outerHTML}extractUrls(){const e=Array.from(document.querySelectorAll("a")),t=new Set;for(const a of e){const e=a.href;if(e&&!n(e))try{const n=new URL(e);t.add(r(n,{removeHash:!0}))}catch{}}return Array.from(t)}extractPlainText(){var e;const t=document.body;if(!t)return"";const n=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,{acceptNode:e=>{const t=e.parentElement;return t&&t.matches("script, style, noscript")?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),r=[];let a=n.nextNode();for(;a;){const t=null==(e=a.textContent)?void 0:e.trim();t&&r.push(t),a=n.nextNode()}return r.join(" ").replace(/\s+/g," ").trim()}evaluateXPath(e,t,n){return new u(document.evaluate(e,t.getUnderlyingNode(),null,n,null))}async waitForElement(e,t=1e4){return new Promise(((n,r)=>{let s,l;const c=()=>{clearInterval(s),clearTimeout(l)};s=setInterval((()=>{document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue&&(c(),n())}),100),l=setTimeout((()=>{c(),r(new a(`Timeout waiting for element with xpath: ${e}`,o.TIMEOUT,e,document.documentElement.outerHTML,t))}),t)}))}}if(window.location.ancestorOrigins.contains(chrome.runtime.getURL("").slice(0,-1))){const e=c();try{window.addEventListener("message",(e=>{if(e.data&&"extractDataFromIframe"===e.data.action){const t=e.data.executionId;(async e=>{const t=new d;return s(t).extractDataByRulesWithCaptchaCheck(e).then((e=>e)).catch((e=>e)).finally((()=>{t.cleanup()}))})(e.data.rules).then((e=>{l.sendMessageWithoutResponse("offscreen.frame.dataExtracted",{data:e,executionId:t})})).catch((e=>{l.sendMessageWithoutResponse("offscreen.frame.dataExtracted",{error:e.toJSON(),executionId:t})}))}})),window.parent.postMessage({action:"iframeReady"},"*")}catch(m){e.captureException(m)}}
