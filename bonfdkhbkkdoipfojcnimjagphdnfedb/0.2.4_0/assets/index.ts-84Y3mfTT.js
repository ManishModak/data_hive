var e=Object.defineProperty,t=(t,n,r)=>((t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r)(t,"symbol"!=typeof n?n+"":n,r);!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="23770625-9c62-46bf-8989-0449d3452d50",e._sentryDebugIdIdentifier="sentry-dbid-23770625-9c62-46bf-8989-0449d3452d50")}catch(n){}}();import{i as n}from"./init-sQey_HaX.js";import{C as r,E as i,B as a,m as s,g as o}from"./messenger-Bd6yZOQZ.js";import"./_sentry-release-injection-file-BetQGEEZ.js";import{R as c}from"./types-Oyjdt06n.js";import{T as u}from"./timeout-error-XFbXKjB0.js";import{g as l,s as d,a as p,l as h}from"./logger-DXqFobQ1.js";import"./index-gLr4Bb9A.js";
/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function f(e){return null==e}var m={isNothing:f,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:f(e)?[]:[e]},repeat:function(e,t){var n,r="";for(n=0;n<t;n+=1)r+=e;return r},isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:function(e,t){var n,r,i,a;if(t)for(n=0,r=(a=Object.keys(t)).length;n<r;n+=1)e[i=a[n]]=t[i];return e}};function g(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),r+" "+n):r}function y(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=g(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}y.prototype=Object.create(Error.prototype),y.prototype.constructor=y,y.prototype.toString=function(e){return this.name+": "+g(this,e)};var v=y;function _(e,t,n,r,i){var a="",s="",o=Math.floor(i/2)-1;return r-t>o&&(t=r-o+(a=" ... ").length),n-r>o&&(n=r+o-(s=" ...").length),{str:a+e.slice(t,n).replace(/\t/g,"â†’")+s,pos:r-t+a.length}}function b(e,t){return m.repeat(" ",t-e.length)+e}var x=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,r=/\r?\n|\r|\0/g,i=[0],a=[],s=-1;n=r.exec(e.buffer);)a.push(n.index),i.push(n.index+n[0].length),e.position<=n.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var o,c,u="",l=Math.min(e.line+t.linesAfter,a.length).toString().length,d=t.maxLength-(t.indent+l+3);for(o=1;o<=t.linesBefore&&!(s-o<0);o++)c=_(e.buffer,i[s-o],a[s-o],e.position-(i[s]-i[s-o]),d),u=m.repeat(" ",t.indent)+b((e.line-o+1).toString(),l)+" | "+c.str+"\n"+u;for(c=_(e.buffer,i[s],a[s],e.position,d),u+=m.repeat(" ",t.indent)+b((e.line+1).toString(),l)+" | "+c.str+"\n",u+=m.repeat("-",t.indent+l+3+c.pos)+"^\n",o=1;o<=t.linesAfter&&!(s+o>=a.length);o++)c=_(e.buffer,i[s+o],a[s+o],e.position-(i[s]-i[s+o]),d),u+=m.repeat(" ",t.indent)+b((e.line+o+1).toString(),l)+" | "+c.str+"\n";return u.replace(/\n$/,"")},w=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],k=["scalar","sequence","mapping"];var C=function(e,t){var n,r;if(t=t||{},Object.keys(t).forEach((function(t){if(-1===w.indexOf(t))throw new v('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=(n=t.styleAliases||null,r={},null!==n&&Object.keys(n).forEach((function(e){n[e].forEach((function(t){r[String(t)]=e}))})),r),-1===k.indexOf(this.kind))throw new v('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function T(e,t){var n=[];return e[t].forEach((function(e){var t=n.length;n.forEach((function(n,r){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=r)})),n[t]=e})),n}function A(e){return this.extend(e)}A.prototype.extend=function(e){var t=[],n=[];if(e instanceof C)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new v("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof C))throw new v("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new v("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new v("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),n.forEach((function(e){if(!(e instanceof C))throw new v("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var r=Object.create(A.prototype);return r.implicit=(this.implicit||[]).concat(t),r.explicit=(this.explicit||[]).concat(n),r.compiledImplicit=T(r,"implicit"),r.compiledExplicit=T(r,"explicit"),r.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function r(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}(r.compiledImplicit,r.compiledExplicit),r};var I=new A({explicit:[new C("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),new C("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),new C("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})]});var N=new C("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});var S=new C("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function E(e){return 48<=e&&e<=55}function j(e){return 48<=e&&e<=57}var O=new C("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=e.length,i=0,a=!1;if(!r)return!1;if("-"!==(t=e[i])&&"+"!==t||(t=e[++i]),"0"===t){if(i+1===r)return!0;if("b"===(t=e[++i])){for(i++;i<r;i++)if("_"!==(t=e[i])){if("0"!==t&&"1"!==t)return!1;a=!0}return a&&"_"!==t}if("x"===t){for(i++;i<r;i++)if("_"!==(t=e[i])){if(!(48<=(n=e.charCodeAt(i))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;a=!0}return a&&"_"!==t}if("o"===t){for(i++;i<r;i++)if("_"!==(t=e[i])){if(!E(e.charCodeAt(i)))return!1;a=!0}return a&&"_"!==t}}if("_"===t)return!1;for(;i<r;i++)if("_"!==(t=e[i])){if(!j(e.charCodeAt(i)))return!1;a=!0}return!(!a||"_"===t)},construct:function(e){var t,n=e,r=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(r=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return r*parseInt(n.slice(2),2);if("x"===n[1])return r*parseInt(n.slice(2),16);if("o"===n[1])return r*parseInt(n.slice(2),8)}return r*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!m.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Z=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");var R=/^[-+]?[0-9]+e/;var M=new C("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!Z.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||m.isNegativeZero(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(m.isNegativeZero(e))return"-0.0";return n=e.toString(10),R.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),P=I.extend({implicit:[N,S,O,M]}),L=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),F=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");var $=new C("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==L.exec(e)||null!==F.exec(e))},construct:function(e){var t,n,r,i,a,s,o,c,u=0,l=null;if(null===(t=L.exec(e))&&(t=F.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,r,i));if(a=+t[4],s=+t[5],o=+t[6],t[7]){for(u=t[7].slice(0,3);u.length<3;)u+="0";u=+u}return t[9]&&(l=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(l=-l)),c=new Date(Date.UTC(n,r,i,a,s,o,u)),l&&c.setTime(c.getTime()-l),c},instanceOf:Date,represent:function(e){return e.toISOString()}});var D=new C("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";var J=new C("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=0,i=e.length,a=U;for(n=0;n<i;n++)if(!((t=a.indexOf(e.charAt(n)))>64)){if(t<0)return!1;r+=6}return r%8==0},construct:function(e){var t,n,r=e.replace(/[\r\n=]/g,""),i=r.length,a=U,s=0,o=[];for(t=0;t<i;t++)t%4==0&&t&&(o.push(s>>16&255),o.push(s>>8&255),o.push(255&s)),s=s<<6|a.indexOf(r.charAt(t));return 0===(n=i%4*6)?(o.push(s>>16&255),o.push(s>>8&255),o.push(255&s)):18===n?(o.push(s>>10&255),o.push(s>>2&255)):12===n&&o.push(s>>4&255),new Uint8Array(o)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,r="",i=0,a=e.length,s=U;for(t=0;t<a;t++)t%3==0&&t&&(r+=s[i>>18&63],r+=s[i>>12&63],r+=s[i>>6&63],r+=s[63&i]),i=(i<<8)+e[t];return 0===(n=a%3)?(r+=s[i>>18&63],r+=s[i>>12&63],r+=s[i>>6&63],r+=s[63&i]):2===n?(r+=s[i>>10&63],r+=s[i>>4&63],r+=s[i<<2&63],r+=s[64]):1===n&&(r+=s[i>>2&63],r+=s[i<<4&63],r+=s[64],r+=s[64]),r}}),V=Object.prototype.hasOwnProperty,z=Object.prototype.toString;var H=new C("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,i,a,s=[],o=e;for(t=0,n=o.length;t<n;t+=1){if(r=o[t],a=!1,"[object Object]"!==z.call(r))return!1;for(i in r)if(V.call(r,i)){if(a)return!1;a=!0}if(!a)return!1;if(-1!==s.indexOf(i))return!1;s.push(i)}return!0},construct:function(e){return null!==e?e:[]}}),B=Object.prototype.toString;var q=new C("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,i,a,s=e;for(a=new Array(s.length),t=0,n=s.length;t<n;t+=1){if(r=s[t],"[object Object]"!==B.call(r))return!1;if(1!==(i=Object.keys(r)).length)return!1;a[t]=[i[0],r[i[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,r,i,a,s=e;for(a=new Array(s.length),t=0,n=s.length;t<n;t+=1)r=s[t],i=Object.keys(r),a[t]=[i[0],r[i[0]]];return a}}),W=Object.prototype.hasOwnProperty;var K=new C("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(W.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),G=P.extend({implicit:[$,D],explicit:[J,H,q,K]}),Y=Object.prototype.hasOwnProperty,X=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Q=/[\x85\u2028\u2029]/,ee=/[,\[\]\{\}]/,te=/^(?:!|!!|![a-z\-]+!)$/i,ne=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function re(e){return Object.prototype.toString.call(e)}function ie(e){return 10===e||13===e}function ae(e){return 9===e||32===e}function se(e){return 9===e||32===e||10===e||13===e}function oe(e){return 44===e||91===e||93===e||123===e||125===e}function ce(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function ue(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"Â…":95===e?"Â ":76===e?"\u2028":80===e?"\u2029":""}function le(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var de=new Array(256),pe=new Array(256),he=0;he<256;he++)de[he]=ue(he)?1:0,pe[he]=ue(he);function fe(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||G,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function me(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=x(n),new v(t,n)}function ge(e,t){throw me(e,t)}function ye(e,t){e.onWarning&&e.onWarning.call(null,me(e,t))}var ve={YAML:function(e,t,n){var r,i,a;null!==e.version&&ge(e,"duplication of %YAML directive"),1!==n.length&&ge(e,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&ge(e,"ill-formed argument of the YAML directive"),i=parseInt(r[1],10),a=parseInt(r[2],10),1!==i&&ge(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=a<2,1!==a&&2!==a&&ye(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var r,i;2!==n.length&&ge(e,"TAG directive accepts exactly two arguments"),r=n[0],i=n[1],te.test(r)||ge(e,"ill-formed tag handle (first argument) of the TAG directive"),Y.call(e.tagMap,r)&&ge(e,'there is a previously declared suffix for "'+r+'" tag handle'),ne.test(i)||ge(e,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch(a){ge(e,"tag prefix is malformed: "+i)}e.tagMap[r]=i}};function _e(e,t,n,r){var i,a,s,o;if(t<n){if(o=e.input.slice(t,n),r)for(i=0,a=o.length;i<a;i+=1)9===(s=o.charCodeAt(i))||32<=s&&s<=1114111||ge(e,"expected valid JSON character");else X.test(o)&&ge(e,"the stream contains non-printable characters");e.result+=o}}function be(e,t,n,r){var i,a,s,o;for(m.isObject(n)||ge(e,"cannot merge mappings; the provided source object is unacceptable"),s=0,o=(i=Object.keys(n)).length;s<o;s+=1)a=i[s],Y.call(t,a)||(t[a]=n[a],r[a]=!0)}function xe(e,t,n,r,i,a,s,o,c){var u,l;if(Array.isArray(i))for(u=0,l=(i=Array.prototype.slice.call(i)).length;u<l;u+=1)Array.isArray(i[u])&&ge(e,"nested arrays are not supported inside keys"),"object"==typeof i&&"[object Object]"===re(i[u])&&(i[u]="[object Object]");if("object"==typeof i&&"[object Object]"===re(i)&&(i="[object Object]"),i=String(i),null===t&&(t={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(a))for(u=0,l=a.length;u<l;u+=1)be(e,t,a[u],n);else be(e,t,a,n);else e.json||Y.call(n,i)||!Y.call(t,i)||(e.line=s||e.line,e.lineStart=o||e.lineStart,e.position=c||e.position,ge(e,"duplicated mapping key")),"__proto__"===i?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:a}):t[i]=a,delete n[i];return t}function we(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):ge(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function ke(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);0!==i;){for(;ae(i);)9===i&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&35===i)do{i=e.input.charCodeAt(++e.position)}while(10!==i&&13!==i&&0!==i);if(!ie(i))break;for(we(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;32===i;)e.lineIndent++,i=e.input.charCodeAt(++e.position)}return-1!==n&&0!==r&&e.lineIndent<n&&ye(e,"deficient indentation"),r}function Ce(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!se(t)))}function Te(e,t){1===t?e.result+=" ":t>1&&(e.result+=m.repeat("\n",t-1))}function Ae(e,t){var n,r,i=e.tag,a=e.anchor,s=[],o=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=s),r=e.input.charCodeAt(e.position);0!==r&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,ge(e,"tab characters must not be used in indentation")),45===r)&&se(e.input.charCodeAt(e.position+1));)if(o=!0,e.position++,ke(e,!0,-1)&&e.lineIndent<=t)s.push(null),r=e.input.charCodeAt(e.position);else if(n=e.line,Se(e,t,3,!1,!0),s.push(e.result),ke(e,!0,-1),r=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==r)ge(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!o&&(e.tag=i,e.anchor=a,e.kind="sequence",e.result=s,!0)}function Ie(e){var t,n,r,i,a=!1,s=!1;if(33!==(i=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&ge(e,"duplication of a tag property"),60===(i=e.input.charCodeAt(++e.position))?(a=!0,i=e.input.charCodeAt(++e.position)):33===i?(s=!0,n="!!",i=e.input.charCodeAt(++e.position)):n="!",t=e.position,a){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&62!==i);e.position<e.length?(r=e.input.slice(t,e.position),i=e.input.charCodeAt(++e.position)):ge(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==i&&!se(i);)33===i&&(s?ge(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),te.test(n)||ge(e,"named tag handle cannot contain such characters"),s=!0,t=e.position+1)),i=e.input.charCodeAt(++e.position);r=e.input.slice(t,e.position),ee.test(r)&&ge(e,"tag suffix cannot contain flow indicator characters")}r&&!ne.test(r)&&ge(e,"tag name cannot contain such characters: "+r);try{r=decodeURIComponent(r)}catch(o){ge(e,"tag name is malformed: "+r)}return a?e.tag=r:Y.call(e.tagMap,n)?e.tag=e.tagMap[n]+r:"!"===n?e.tag="!"+r:"!!"===n?e.tag="tag:yaml.org,2002:"+r:ge(e,'undeclared tag handle "'+n+'"'),!0}function Ne(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&ge(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!se(n)&&!oe(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&ge(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function Se(e,t,n,r,i){var a,s,o,c,u,l,d,p,h,f=1,g=!1,y=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,a=s=o=4===n||3===n,r&&ke(e,!0,-1)&&(g=!0,e.lineIndent>t?f=1:e.lineIndent===t?f=0:e.lineIndent<t&&(f=-1)),1===f)for(;Ie(e)||Ne(e);)ke(e,!0,-1)?(g=!0,o=a,e.lineIndent>t?f=1:e.lineIndent===t?f=0:e.lineIndent<t&&(f=-1)):o=!1;if(o&&(o=g||i),1!==f&&4!==n||(p=1===n||2===n?t:t+1,h=e.position-e.lineStart,1===f?o&&(Ae(e,h)||function(e,t,n){var r,i,a,s,o,c,u,l=e.tag,d=e.anchor,p={},h=Object.create(null),f=null,m=null,g=null,y=!1,v=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=p),u=e.input.charCodeAt(e.position);0!==u;){if(y||-1===e.firstTabInLine||(e.position=e.firstTabInLine,ge(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),a=e.line,63!==u&&58!==u||!se(r)){if(s=e.line,o=e.lineStart,c=e.position,!Se(e,n,2,!1,!0))break;if(e.line===a){for(u=e.input.charCodeAt(e.position);ae(u);)u=e.input.charCodeAt(++e.position);if(58===u)se(u=e.input.charCodeAt(++e.position))||ge(e,"a whitespace character is expected after the key-value separator within a block mapping"),y&&(xe(e,p,h,f,m,null,s,o,c),f=m=g=null),v=!0,y=!1,i=!1,f=e.tag,m=e.result;else{if(!v)return e.tag=l,e.anchor=d,!0;ge(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!v)return e.tag=l,e.anchor=d,!0;ge(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===u?(y&&(xe(e,p,h,f,m,null,s,o,c),f=m=g=null),v=!0,y=!0,i=!0):y?(y=!1,i=!0):ge(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,u=r;if((e.line===a||e.lineIndent>t)&&(y&&(s=e.line,o=e.lineStart,c=e.position),Se(e,t,4,!0,i)&&(y?m=e.result:g=e.result),y||(xe(e,p,h,f,m,g,s,o,c),f=m=g=null),ke(e,!0,-1),u=e.input.charCodeAt(e.position)),(e.line===a||e.lineIndent>t)&&0!==u)ge(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return y&&xe(e,p,h,f,m,null,s,o,c),v&&(e.tag=l,e.anchor=d,e.kind="mapping",e.result=p),v}(e,h,p))||function(e,t){var n,r,i,a,s,o,c,u,l,d,p,h,f=!0,m=e.tag,g=e.anchor,y=Object.create(null);if(91===(h=e.input.charCodeAt(e.position)))s=93,u=!1,a=[];else{if(123!==h)return!1;s=125,u=!0,a={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=a),h=e.input.charCodeAt(++e.position);0!==h;){if(ke(e,!0,t),(h=e.input.charCodeAt(e.position))===s)return e.position++,e.tag=m,e.anchor=g,e.kind=u?"mapping":"sequence",e.result=a,!0;f?44===h&&ge(e,"expected the node content, but found ','"):ge(e,"missed comma between flow collection entries"),p=null,o=c=!1,63===h&&se(e.input.charCodeAt(e.position+1))&&(o=c=!0,e.position++,ke(e,!0,t)),n=e.line,r=e.lineStart,i=e.position,Se(e,t,1,!1,!0),d=e.tag,l=e.result,ke(e,!0,t),h=e.input.charCodeAt(e.position),!c&&e.line!==n||58!==h||(o=!0,h=e.input.charCodeAt(++e.position),ke(e,!0,t),Se(e,t,1,!1,!0),p=e.result),u?xe(e,a,y,d,l,p,n,r,i):o?a.push(xe(e,null,y,d,l,p,n,r,i)):a.push(l),ke(e,!0,t),44===(h=e.input.charCodeAt(e.position))?(f=!0,h=e.input.charCodeAt(++e.position)):f=!1}ge(e,"unexpected end of the stream within a flow collection")}(e,p)?y=!0:(s&&function(e,t){var n,r,i,a,s,o=1,c=!1,u=!1,l=t,d=0,p=!1;if(124===(a=e.input.charCodeAt(e.position)))r=!1;else{if(62!==a)return!1;r=!0}for(e.kind="scalar",e.result="";0!==a;)if(43===(a=e.input.charCodeAt(++e.position))||45===a)1===o?o=43===a?3:2:ge(e,"repeat of a chomping mode identifier");else{if(!((i=48<=(s=a)&&s<=57?s-48:-1)>=0))break;0===i?ge(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):u?ge(e,"repeat of an indentation width identifier"):(l=t+i-1,u=!0)}if(ae(a)){do{a=e.input.charCodeAt(++e.position)}while(ae(a));if(35===a)do{a=e.input.charCodeAt(++e.position)}while(!ie(a)&&0!==a)}for(;0!==a;){for(we(e),e.lineIndent=0,a=e.input.charCodeAt(e.position);(!u||e.lineIndent<l)&&32===a;)e.lineIndent++,a=e.input.charCodeAt(++e.position);if(!u&&e.lineIndent>l&&(l=e.lineIndent),ie(a))d++;else{if(e.lineIndent<l){3===o?e.result+=m.repeat("\n",c?1+d:d):1===o&&c&&(e.result+="\n");break}for(r?ae(a)?(p=!0,e.result+=m.repeat("\n",c?1+d:d)):p?(p=!1,e.result+=m.repeat("\n",d+1)):0===d?c&&(e.result+=" "):e.result+=m.repeat("\n",d):e.result+=m.repeat("\n",c?1+d:d),c=!0,u=!0,d=0,n=e.position;!ie(a)&&0!==a;)a=e.input.charCodeAt(++e.position);_e(e,n,e.position,!1)}}return!0}(e,p)||function(e,t){var n,r,i;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(_e(e,r,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;r=e.position,e.position++,i=e.position}else ie(n)?(_e(e,r,i,!0),Te(e,ke(e,!1,t)),r=i=e.position):e.position===e.lineStart&&Ce(e)?ge(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);ge(e,"unexpected end of the stream within a single quoted scalar")}(e,p)||function(e,t){var n,r,i,a,s,o,c;if(34!==(o=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;0!==(o=e.input.charCodeAt(e.position));){if(34===o)return _e(e,n,e.position,!0),e.position++,!0;if(92===o){if(_e(e,n,e.position,!0),ie(o=e.input.charCodeAt(++e.position)))ke(e,!1,t);else if(o<256&&de[o])e.result+=pe[o],e.position++;else if((s=120===(c=o)?2:117===c?4:85===c?8:0)>0){for(i=s,a=0;i>0;i--)(s=ce(o=e.input.charCodeAt(++e.position)))>=0?a=(a<<4)+s:ge(e,"expected hexadecimal character");e.result+=le(a),e.position++}else ge(e,"unknown escape sequence");n=r=e.position}else ie(o)?(_e(e,n,r,!0),Te(e,ke(e,!1,t)),n=r=e.position):e.position===e.lineStart&&Ce(e)?ge(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}ge(e,"unexpected end of the stream within a double quoted scalar")}(e,p)?y=!0:!function(e){var t,n,r;if(42!==(r=e.input.charCodeAt(e.position)))return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!se(r)&&!oe(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&ge(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Y.call(e.anchorMap,n)||ge(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],ke(e,!0,-1),!0}(e)?function(e,t,n){var r,i,a,s,o,c,u,l,d=e.kind,p=e.result;if(se(l=e.input.charCodeAt(e.position))||oe(l)||35===l||38===l||42===l||33===l||124===l||62===l||39===l||34===l||37===l||64===l||96===l)return!1;if((63===l||45===l)&&(se(r=e.input.charCodeAt(e.position+1))||n&&oe(r)))return!1;for(e.kind="scalar",e.result="",i=a=e.position,s=!1;0!==l;){if(58===l){if(se(r=e.input.charCodeAt(e.position+1))||n&&oe(r))break}else if(35===l){if(se(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&Ce(e)||n&&oe(l))break;if(ie(l)){if(o=e.line,c=e.lineStart,u=e.lineIndent,ke(e,!1,-1),e.lineIndent>=t){s=!0,l=e.input.charCodeAt(e.position);continue}e.position=a,e.line=o,e.lineStart=c,e.lineIndent=u;break}}s&&(_e(e,i,a,!1),Te(e,e.line-o),i=a=e.position,s=!1),ae(l)||(a=e.position+1),l=e.input.charCodeAt(++e.position)}return _e(e,i,a,!1),!!e.result||(e.kind=d,e.result=p,!1)}(e,p,1===n)&&(y=!0,null===e.tag&&(e.tag="?")):(y=!0,null===e.tag&&null===e.anchor||ge(e,"alias node should not have any properties")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===f&&(y=o&&Ae(e,h))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&ge(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),c=0,u=e.implicitTypes.length;c<u;c+=1)if((d=e.implicitTypes[c]).resolve(e.result)){e.result=d.construct(e.result),e.tag=d.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(Y.call(e.typeMap[e.kind||"fallback"],e.tag))d=e.typeMap[e.kind||"fallback"][e.tag];else for(d=null,c=0,u=(l=e.typeMap.multi[e.kind||"fallback"]).length;c<u;c+=1)if(e.tag.slice(0,l[c].tag.length)===l[c].tag){d=l[c];break}d||ge(e,"unknown tag !<"+e.tag+">"),null!==e.result&&d.kind!==e.kind&&ge(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+d.kind+'", not "'+e.kind+'"'),d.resolve(e.result,e.tag)?(e.result=d.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):ge(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||y}function Ee(e){var t,n,r,i,a=e.position,s=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(i=e.input.charCodeAt(e.position))&&(ke(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==i));){for(s=!0,i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!se(i);)i=e.input.charCodeAt(++e.position);for(r=[],(n=e.input.slice(t,e.position)).length<1&&ge(e,"directive name must not be less than one character in length");0!==i;){for(;ae(i);)i=e.input.charCodeAt(++e.position);if(35===i){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&!ie(i));break}if(ie(i))break;for(t=e.position;0!==i&&!se(i);)i=e.input.charCodeAt(++e.position);r.push(e.input.slice(t,e.position))}0!==i&&we(e),Y.call(ve,n)?ve[n](e,n,r):ye(e,'unknown document directive "'+n+'"')}ke(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,ke(e,!0,-1)):s&&ge(e,"directives end mark is expected"),Se(e,e.lineIndent-1,4,!1,!0),ke(e,!0,-1),e.checkLineBreaks&&Q.test(e.input.slice(a,e.position))&&ye(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Ce(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,ke(e,!0,-1)):e.position<e.length-1&&ge(e,"end of the stream or a document separator is expected")}var je,Oe,Ze,Re={load:function(e,t){var n=function(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new fe(e,t),r=e.indexOf("\0");for(-1!==r&&(n.position=r,ge(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)Ee(n);return n.documents}(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new v("expected a single document in the stream, but found more")}}}.load;(Oe=je||(je={})).assertEqual=e=>e,Oe.assertIs=function(e){},Oe.assertNever=function(e){throw new Error},Oe.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},Oe.getValidEnumValues=e=>{const t=Oe.objectKeys(e).filter((t=>"number"!=typeof e[e[t]])),n={};for(const r of t)n[r]=e[r];return Oe.objectValues(n)},Oe.objectValues=e=>Oe.objectKeys(e).map((function(t){return e[t]})),Oe.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},Oe.find=(e,t)=>{for(const n of e)if(t(n))return n},Oe.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,Oe.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},Oe.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(Ze||(Ze={})).mergeShapes=(e,t)=>({...e,...t});const Me=je.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Pe=e=>{switch(typeof e){case"undefined":return Me.undefined;case"string":return Me.string;case"number":return isNaN(e)?Me.nan:Me.number;case"boolean":return Me.boolean;case"function":return Me.function;case"bigint":return Me.bigint;case"symbol":return Me.symbol;case"object":return Array.isArray(e)?Me.array:null===e?Me.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?Me.promise:"undefined"!=typeof Map&&e instanceof Map?Me.map:"undefined"!=typeof Set&&e instanceof Set?Me.set:"undefined"!=typeof Date&&e instanceof Date?Me.date:Me.object;default:return Me.unknown}},Le=je.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Fe extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},n={_errors:[]},r=e=>{for(const i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(r);else if("invalid_return_type"===i.code)r(i.returnTypeError);else if("invalid_arguments"===i.code)r(i.argumentsError);else if(0===i.path.length)n._errors.push(t(i));else{let e=n,r=0;for(;r<i.path.length;){const n=i.path[r];r===i.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(i))):e[n]=e[n]||{_errors:[]},e=e[n],r++}}};return r(this),n}static assert(e){if(!(e instanceof Fe))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,je.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},n=[];for(const r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}Fe.create=e=>new Fe(e);const $e=(e,t)=>{let n;switch(e.code){case Le.invalid_type:n=e.received===Me.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case Le.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,je.jsonStringifyReplacer)}`;break;case Le.unrecognized_keys:n=`Unrecognized key(s) in object: ${je.joinValues(e.keys,", ")}`;break;case Le.invalid_union:n="Invalid input";break;case Le.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${je.joinValues(e.options)}`;break;case Le.invalid_enum_value:n=`Invalid enum value. Expected ${je.joinValues(e.options)}, received '${e.received}'`;break;case Le.invalid_arguments:n="Invalid function arguments";break;case Le.invalid_return_type:n="Invalid function return type";break;case Le.invalid_date:n="Invalid date";break;case Le.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:je.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case Le.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case Le.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case Le.custom:n="Invalid input";break;case Le.invalid_intersection_types:n="Intersection results could not be merged";break;case Le.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Le.not_finite:n="Number must be finite";break;default:n=t.defaultError,je.assertNever(e)}return{message:n}};let De=$e;function Ue(){return De}const Je=e=>{const{data:t,path:n,errorMaps:r,issueData:i}=e,a=[...n,...i.path||[]],s={...i,path:a};if(void 0!==i.message)return{...i,path:a,message:i.message};let o="";const c=r.filter((e=>!!e)).slice().reverse();for(const u of c)o=u(s,{data:t,defaultError:o}).message;return{...i,path:a,message:o}};function Ve(e,t){const n=Ue(),r=Je({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===$e?void 0:$e].filter((e=>!!e))});e.common.issues.push(r)}class ze{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const r of t){if("aborted"===r.status)return He;"dirty"===r.status&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const r of t){const e=await r.key,t=await r.value;n.push({key:e,value:t})}return ze.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const r of t){const{key:t,value:i}=r;if("aborted"===t.status)return He;if("aborted"===i.status)return He;"dirty"===t.status&&e.dirty(),"dirty"===i.status&&e.dirty(),"__proto__"===t.value||void 0===i.value&&!r.alwaysSet||(n[t.value]=i.value)}return{status:e.value,value:n}}}const He=Object.freeze({status:"aborted"}),Be=e=>({status:"dirty",value:e}),qe=e=>({status:"valid",value:e}),We=e=>"aborted"===e.status,Ke=e=>"dirty"===e.status,Ge=e=>"valid"===e.status,Ye=e=>"undefined"!=typeof Promise&&e instanceof Promise;function Xe(e,t,n,r){if("function"==typeof t||!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function Qe(e,t,n,r,i){if("function"==typeof t||!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}var et,tt,nt,rt;"function"==typeof SuppressedError&&SuppressedError,(tt=et||(et={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},tt.toString=e=>"string"==typeof e?e:null==e?void 0:e.message;class it{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const at=(e,t)=>{if(Ge(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Fe(e.common.issues);return this._error=t,this._error}}};function st(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:i}=e;if(t&&(n||r))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:i};return{errorMap:(t,i)=>{var a,s;const{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:i.defaultError}:void 0===i.data?{message:null!==(a=null!=o?o:r)&&void 0!==a?a:i.defaultError}:"invalid_type"!==t.code?{message:i.defaultError}:{message:null!==(s=null!=o?o:n)&&void 0!==s?s:i.defaultError}},description:i}}class ot{get description(){return this._def.description}_getType(e){return Pe(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Pe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ze,ctx:{common:e.parent.common,data:e.data,parsedType:Pe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Ye(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:null!==(n=null==t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Pe(e)},i=this._parseSync({data:e,path:r.path,parent:r});return at(r,i)}"~validate"(e){var t,n;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Pe(e)};if(!this["~standard"].async)try{const t=this._parseSync({data:e,path:[],parent:r});return Ge(t)?{value:t.value}:{issues:r.common.issues}}catch(i){(null===(n=null===(t=null==i?void 0:i.message)||void 0===t?void 0:t.toLowerCase())||void 0===n?void 0:n.includes("encountered"))&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then((e=>Ge(e)?{value:e.value}:{issues:r.common.issues}))}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Pe(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(Ye(r)?r:Promise.resolve(r));return at(n,i)}refine(e,t){const n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,r)=>{const i=e(t),a=()=>r.addIssue({code:Le.custom,...n(t)});return"undefined"!=typeof Promise&&i instanceof Promise?i.then((e=>!!e||(a(),!1))):!!i||(a(),!1)}))}refinement(e,t){return this._refinement(((n,r)=>!!e(n)||(r.addIssue("function"==typeof t?t(n,r):t),!1)))}_refinement(e){return new cn({schema:this,typeName:xn.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return un.create(this,this._def)}nullable(){return ln.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Jt.create(this)}promise(){return on.create(this,this._def)}or(e){return Ht.create([this,e],this._def)}and(e){return Kt.create(this,e,this._def)}transform(e){return new cn({...st(this._def),schema:this,typeName:xn.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new dn({...st(this._def),innerType:this,defaultValue:t,typeName:xn.ZodDefault})}brand(){return new mn({typeName:xn.ZodBranded,type:this,...st(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new pn({...st(this._def),innerType:this,catchValue:t,typeName:xn.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return gn.create(this,e)}readonly(){return yn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const ct=/^c[^\s-]{8,}$/i,ut=/^[0-9a-z]+$/,lt=/^[0-9A-HJKMNP-TV-Z]{26}$/i,dt=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,pt=/^[a-z0-9_-]{21}$/i,ht=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,ft=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,mt=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let gt;const yt=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,vt=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,_t=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,bt=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,xt=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,wt=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,kt="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Ct=new RegExp(`^${kt}$`);function Tt(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function At(e){let t=`${kt}T${Tt(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function It(e,t){if(!ht.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return"object"==typeof i&&null!==i&&(!(!i.typ||!i.alg)&&(!t||i.alg===t))}catch(n){return!1}}function Nt(e,t){return!("v4"!==t&&t||!vt.test(e))||!("v6"!==t&&t||!bt.test(e))}class St extends ot{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==Me.string){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.string,received:t.parsedType}),He}const t=new ze;let n;for(const s of this._def.checks)if("min"===s.kind)e.data.length<s.value&&(n=this._getOrReturnCtx(e,n),Ve(n,{code:Le.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),t.dirty());else if("max"===s.kind)e.data.length>s.value&&(n=this._getOrReturnCtx(e,n),Ve(n,{code:Le.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),t.dirty());else if("length"===s.kind){const r=e.data.length>s.value,i=e.data.length<s.value;(r||i)&&(n=this._getOrReturnCtx(e,n),r?Ve(n,{code:Le.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):i&&Ve(n,{code:Le.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),t.dirty())}else if("email"===s.kind)mt.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"email",code:Le.invalid_string,message:s.message}),t.dirty());else if("emoji"===s.kind)gt||(gt=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),gt.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"emoji",code:Le.invalid_string,message:s.message}),t.dirty());else if("uuid"===s.kind)dt.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"uuid",code:Le.invalid_string,message:s.message}),t.dirty());else if("nanoid"===s.kind)pt.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"nanoid",code:Le.invalid_string,message:s.message}),t.dirty());else if("cuid"===s.kind)ct.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"cuid",code:Le.invalid_string,message:s.message}),t.dirty());else if("cuid2"===s.kind)ut.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"cuid2",code:Le.invalid_string,message:s.message}),t.dirty());else if("ulid"===s.kind)lt.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"ulid",code:Le.invalid_string,message:s.message}),t.dirty());else if("url"===s.kind)try{new URL(e.data)}catch(a){n=this._getOrReturnCtx(e,n),Ve(n,{validation:"url",code:Le.invalid_string,message:s.message}),t.dirty()}else if("regex"===s.kind){s.regex.lastIndex=0;s.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"regex",code:Le.invalid_string,message:s.message}),t.dirty())}else if("trim"===s.kind)e.data=e.data.trim();else if("includes"===s.kind)e.data.includes(s.value,s.position)||(n=this._getOrReturnCtx(e,n),Ve(n,{code:Le.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),t.dirty());else if("toLowerCase"===s.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===s.kind)e.data=e.data.toUpperCase();else if("startsWith"===s.kind)e.data.startsWith(s.value)||(n=this._getOrReturnCtx(e,n),Ve(n,{code:Le.invalid_string,validation:{startsWith:s.value},message:s.message}),t.dirty());else if("endsWith"===s.kind)e.data.endsWith(s.value)||(n=this._getOrReturnCtx(e,n),Ve(n,{code:Le.invalid_string,validation:{endsWith:s.value},message:s.message}),t.dirty());else if("datetime"===s.kind){At(s).test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{code:Le.invalid_string,validation:"datetime",message:s.message}),t.dirty())}else if("date"===s.kind){Ct.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{code:Le.invalid_string,validation:"date",message:s.message}),t.dirty())}else if("time"===s.kind){new RegExp(`^${Tt(s)}$`).test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{code:Le.invalid_string,validation:"time",message:s.message}),t.dirty())}else"duration"===s.kind?ft.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"duration",code:Le.invalid_string,message:s.message}),t.dirty()):"ip"===s.kind?(r=e.data,("v4"!==(i=s.version)&&i||!yt.test(r))&&("v6"!==i&&i||!_t.test(r))&&(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"ip",code:Le.invalid_string,message:s.message}),t.dirty())):"jwt"===s.kind?It(e.data,s.alg)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"jwt",code:Le.invalid_string,message:s.message}),t.dirty()):"cidr"===s.kind?Nt(e.data,s.version)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"cidr",code:Le.invalid_string,message:s.message}),t.dirty()):"base64"===s.kind?xt.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"base64",code:Le.invalid_string,message:s.message}),t.dirty()):"base64url"===s.kind?wt.test(e.data)||(n=this._getOrReturnCtx(e,n),Ve(n,{validation:"base64url",code:Le.invalid_string,message:s.message}),t.dirty()):je.assertNever(s);var r,i;return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),{validation:t,code:Le.invalid_string,...et.errToObj(n)})}_addCheck(e){return new St({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...et.errToObj(e)})}url(e){return this._addCheck({kind:"url",...et.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...et.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...et.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...et.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...et.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...et.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...et.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...et.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...et.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...et.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...et.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...et.errToObj(e)})}datetime(e){var t,n;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(n=null==e?void 0:e.local)&&void 0!==n&&n,...et.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...et.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...et.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...et.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...et.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...et.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...et.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...et.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...et.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...et.errToObj(t)})}nonempty(e){return this.min(1,et.errToObj(e))}trim(){return new St({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new St({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new St({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isCIDR(){return!!this._def.checks.find((e=>"cidr"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get isBase64url(){return!!this._def.checks.find((e=>"base64url"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function Et(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,i=n>r?n:r;return parseInt(e.toFixed(i).replace(".",""))%parseInt(t.toFixed(i).replace(".",""))/Math.pow(10,i)}St.create=e=>{var t;return new St({checks:[],typeName:xn.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...st(e)})};class jt extends ot{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==Me.number){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.number,received:t.parsedType}),He}let t;const n=new ze;for(const r of this._def.checks)if("int"===r.kind)je.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),Ve(t,{code:Le.invalid_type,expected:"integer",received:"float",message:r.message}),n.dirty());else if("min"===r.kind){(r.inclusive?e.data<r.value:e.data<=r.value)&&(t=this._getOrReturnCtx(e,t),Ve(t,{code:Le.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty())}else if("max"===r.kind){(r.inclusive?e.data>r.value:e.data>=r.value)&&(t=this._getOrReturnCtx(e,t),Ve(t,{code:Le.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty())}else"multipleOf"===r.kind?0!==Et(e.data,r.value)&&(t=this._getOrReturnCtx(e,t),Ve(t,{code:Le.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):"finite"===r.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),Ve(t,{code:Le.not_finite,message:r.message}),n.dirty()):je.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,et.toString(t))}gt(e,t){return this.setLimit("min",e,!1,et.toString(t))}lte(e,t){return this.setLimit("max",e,!0,et.toString(t))}lt(e,t){return this.setLimit("max",e,!1,et.toString(t))}setLimit(e,t,n,r){return new jt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:et.toString(r)}]})}_addCheck(e){return new jt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:et.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:et.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:et.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:et.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:et.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:et.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:et.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:et.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:et.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&je.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}jt.create=e=>new jt({checks:[],typeName:xn.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...st(e)});class Ot extends ot{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch(r){return this._getInvalidInput(e)}if(this._getType(e)!==Me.bigint)return this._getInvalidInput(e);let t;const n=new ze;for(const i of this._def.checks)if("min"===i.kind){(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),Ve(t,{code:Le.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty())}else if("max"===i.kind){(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),Ve(t,{code:Le.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty())}else"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),Ve(t,{code:Le.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):je.assertNever(i);return{status:n.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.bigint,received:t.parsedType}),He}gte(e,t){return this.setLimit("min",e,!0,et.toString(t))}gt(e,t){return this.setLimit("min",e,!1,et.toString(t))}lte(e,t){return this.setLimit("max",e,!0,et.toString(t))}lt(e,t){return this.setLimit("max",e,!1,et.toString(t))}setLimit(e,t,n,r){return new Ot({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:et.toString(r)}]})}_addCheck(e){return new Ot({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:et.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:et.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:et.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:et.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:et.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Ot.create=e=>{var t;return new Ot({checks:[],typeName:xn.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...st(e)})};class Zt extends ot{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==Me.boolean){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.boolean,received:t.parsedType}),He}return qe(e.data)}}Zt.create=e=>new Zt({typeName:xn.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...st(e)});class Rt extends ot{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==Me.date){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.date,received:t.parsedType}),He}if(isNaN(e.data.getTime())){return Ve(this._getOrReturnCtx(e),{code:Le.invalid_date}),He}const t=new ze;let n;for(const r of this._def.checks)"min"===r.kind?e.data.getTime()<r.value&&(n=this._getOrReturnCtx(e,n),Ve(n,{code:Le.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),t.dirty()):"max"===r.kind?e.data.getTime()>r.value&&(n=this._getOrReturnCtx(e,n),Ve(n,{code:Le.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),t.dirty()):je.assertNever(r);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Rt({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:et.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:et.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}Rt.create=e=>new Rt({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:xn.ZodDate,...st(e)});class Mt extends ot{_parse(e){if(this._getType(e)!==Me.symbol){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.symbol,received:t.parsedType}),He}return qe(e.data)}}Mt.create=e=>new Mt({typeName:xn.ZodSymbol,...st(e)});class Pt extends ot{_parse(e){if(this._getType(e)!==Me.undefined){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.undefined,received:t.parsedType}),He}return qe(e.data)}}Pt.create=e=>new Pt({typeName:xn.ZodUndefined,...st(e)});class Lt extends ot{_parse(e){if(this._getType(e)!==Me.null){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.null,received:t.parsedType}),He}return qe(e.data)}}Lt.create=e=>new Lt({typeName:xn.ZodNull,...st(e)});class Ft extends ot{constructor(){super(...arguments),this._any=!0}_parse(e){return qe(e.data)}}Ft.create=e=>new Ft({typeName:xn.ZodAny,...st(e)});class $t extends ot{constructor(){super(...arguments),this._unknown=!0}_parse(e){return qe(e.data)}}$t.create=e=>new $t({typeName:xn.ZodUnknown,...st(e)});class Dt extends ot{_parse(e){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.never,received:t.parsedType}),He}}Dt.create=e=>new Dt({typeName:xn.ZodNever,...st(e)});class Ut extends ot{_parse(e){if(this._getType(e)!==Me.undefined){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.void,received:t.parsedType}),He}return qe(e.data)}}Ut.create=e=>new Ut({typeName:xn.ZodVoid,...st(e)});class Jt extends ot{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==Me.array)return Ve(t,{code:Le.invalid_type,expected:Me.array,received:t.parsedType}),He;if(null!==r.exactLength){const e=t.data.length>r.exactLength.value,i=t.data.length<r.exactLength.value;(e||i)&&(Ve(t,{code:e?Le.too_big:Le.too_small,minimum:i?r.exactLength.value:void 0,maximum:e?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(null!==r.minLength&&t.data.length<r.minLength.value&&(Ve(t,{code:Le.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),null!==r.maxLength&&t.data.length>r.maxLength.value&&(Ve(t,{code:Le.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>r.type._parseAsync(new it(t,e,t.path,n))))).then((e=>ze.mergeArray(n,e)));const i=[...t.data].map(((e,n)=>r.type._parseSync(new it(t,e,t.path,n))));return ze.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new Jt({...this._def,minLength:{value:e,message:et.toString(t)}})}max(e,t){return new Jt({...this._def,maxLength:{value:e,message:et.toString(t)}})}length(e,t){return new Jt({...this._def,exactLength:{value:e,message:et.toString(t)}})}nonempty(e){return this.min(1,e)}}function Vt(e){if(e instanceof zt){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=un.create(Vt(r))}return new zt({...e._def,shape:()=>t})}return e instanceof Jt?new Jt({...e._def,type:Vt(e.element)}):e instanceof un?un.create(Vt(e.unwrap())):e instanceof ln?ln.create(Vt(e.unwrap())):e instanceof Gt?Gt.create(e.items.map((e=>Vt(e)))):e}Jt.create=(e,t)=>new Jt({type:e,minLength:null,maxLength:null,exactLength:null,typeName:xn.ZodArray,...st(t)});class zt extends ot{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=je.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==Me.object){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.object,received:t.parsedType}),He}const{status:t,ctx:n}=this._processInputParams(e),{shape:r,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof Dt&&"strip"===this._def.unknownKeys))for(const o in n.data)i.includes(o)||a.push(o);const s=[];for(const o of i){const e=r[o],t=n.data[o];s.push({key:{status:"valid",value:o},value:e._parse(new it(n,t,n.path,o)),alwaysSet:o in n.data})}if(this._def.catchall instanceof Dt){const e=this._def.unknownKeys;if("passthrough"===e)for(const t of a)s.push({key:{status:"valid",value:t},value:{status:"valid",value:n.data[t]}});else if("strict"===e)a.length>0&&(Ve(n,{code:Le.unrecognized_keys,keys:a}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of a){const r=n.data[t];s.push({key:{status:"valid",value:t},value:e._parse(new it(n,r,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of s){const n=await t.key,r=await t.value;e.push({key:n,value:r,alwaysSet:t.alwaysSet})}return e})).then((e=>ze.mergeObjectSync(t,e))):ze.mergeObjectSync(t,s)}get shape(){return this._def.shape()}strict(e){return et.errToObj,new zt({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var r,i,a,s;const o=null!==(a=null===(i=(r=this._def).errorMap)||void 0===i?void 0:i.call(r,t,n).message)&&void 0!==a?a:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(s=et.errToObj(e).message)&&void 0!==s?s:o}:{message:o}}}:{}})}strip(){return new zt({...this._def,unknownKeys:"strip"})}passthrough(){return new zt({...this._def,unknownKeys:"passthrough"})}extend(e){return new zt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new zt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:xn.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new zt({...this._def,catchall:e})}pick(e){const t={};return je.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new zt({...this._def,shape:()=>t})}omit(e){const t={};return je.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new zt({...this._def,shape:()=>t})}deepPartial(){return Vt(this)}partial(e){const t={};return je.objectKeys(this.shape).forEach((n=>{const r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()})),new zt({...this._def,shape:()=>t})}required(e){const t={};return je.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof un;)e=e._def.innerType;t[n]=e}})),new zt({...this._def,shape:()=>t})}keyof(){return rn(je.objectKeys(this.shape))}}zt.create=(e,t)=>new zt({shape:()=>e,unknownKeys:"strip",catchall:Dt.create(),typeName:xn.ZodObject,...st(t)}),zt.strictCreate=(e,t)=>new zt({shape:()=>e,unknownKeys:"strict",catchall:Dt.create(),typeName:xn.ZodObject,...st(t)}),zt.lazycreate=(e,t)=>new zt({shape:e,unknownKeys:"strip",catchall:Dt.create(),typeName:xn.ZodObject,...st(t)});class Ht extends ot{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const n=e.map((e=>new Fe(e.ctx.common.issues)));return Ve(t,{code:Le.invalid_union,unionErrors:n}),He}));{let e;const r=[];for(const a of n){const n={...t,common:{...t.common,issues:[]},parent:null},i=a._parseSync({data:t.data,path:t.path,parent:n});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:n}),n.common.issues.length&&r.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const i=r.map((e=>new Fe(e)));return Ve(t,{code:Le.invalid_union,unionErrors:i}),He}}get options(){return this._def.options}}Ht.create=(e,t)=>new Ht({options:e,typeName:xn.ZodUnion,...st(t)});const Bt=e=>e instanceof tn?Bt(e.schema):e instanceof cn?Bt(e.innerType()):e instanceof nn?[e.value]:e instanceof an?e.options:e instanceof sn?je.objectValues(e.enum):e instanceof dn?Bt(e._def.innerType):e instanceof Pt?[void 0]:e instanceof Lt?[null]:e instanceof un?[void 0,...Bt(e.unwrap())]:e instanceof ln?[null,...Bt(e.unwrap())]:e instanceof mn||e instanceof yn?Bt(e.unwrap()):e instanceof pn?Bt(e._def.innerType):[];class qt extends ot{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Me.object)return Ve(t,{code:Le.invalid_type,expected:Me.object,received:t.parsedType}),He;const n=this.discriminator,r=t.data[n],i=this.optionsMap.get(r);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(Ve(t,{code:Le.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),He)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const r=new Map;for(const i of t){const t=Bt(i.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const n of t){if(r.has(n))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(n)}`);r.set(n,i)}}return new qt({typeName:xn.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...st(n)})}}function Wt(e,t){const n=Pe(e),r=Pe(t);if(e===t)return{valid:!0,data:e};if(n===Me.object&&r===Me.object){const n=je.objectKeys(t),r=je.objectKeys(e).filter((e=>-1!==n.indexOf(e))),i={...e,...t};for(const a of r){const n=Wt(e[a],t[a]);if(!n.valid)return{valid:!1};i[a]=n.data}return{valid:!0,data:i}}if(n===Me.array&&r===Me.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let r=0;r<e.length;r++){const i=Wt(e[r],t[r]);if(!i.valid)return{valid:!1};n.push(i.data)}return{valid:!0,data:n}}return n===Me.date&&r===Me.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Kt extends ot{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(e,r)=>{if(We(e)||We(r))return He;const i=Wt(e.value,r.value);return i.valid?((Ke(e)||Ke(r))&&t.dirty(),{status:t.value,value:i.data}):(Ve(n,{code:Le.invalid_intersection_types}),He)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((([e,t])=>r(e,t))):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Kt.create=(e,t,n)=>new Kt({left:e,right:t,typeName:xn.ZodIntersection,...st(n)});class Gt extends ot{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Me.array)return Ve(n,{code:Le.invalid_type,expected:Me.array,received:n.parsedType}),He;if(n.data.length<this._def.items.length)return Ve(n,{code:Le.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),He;!this._def.rest&&n.data.length>this._def.items.length&&(Ve(n,{code:Le.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...n.data].map(((e,t)=>{const r=this._def.items[t]||this._def.rest;return r?r._parse(new it(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(r).then((e=>ze.mergeArray(t,e))):ze.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new Gt({...this._def,rest:e})}}Gt.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Gt({items:e,typeName:xn.ZodTuple,rest:null,...st(t)})};class Yt extends ot{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Me.object)return Ve(n,{code:Le.invalid_type,expected:Me.object,received:n.parsedType}),He;const r=[],i=this._def.keyType,a=this._def.valueType;for(const s in n.data)r.push({key:i._parse(new it(n,s,n.path,s)),value:a._parse(new it(n,n.data[s],n.path,s)),alwaysSet:s in n.data});return n.common.async?ze.mergeObjectAsync(t,r):ze.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return new Yt(t instanceof ot?{keyType:e,valueType:t,typeName:xn.ZodRecord,...st(n)}:{keyType:St.create(),valueType:e,typeName:xn.ZodRecord,...st(t)})}}class Xt extends ot{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Me.map)return Ve(n,{code:Le.invalid_type,expected:Me.map,received:n.parsedType}),He;const r=this._def.keyType,i=this._def.valueType,a=[...n.data.entries()].map((([e,t],a)=>({key:r._parse(new it(n,e,n.path,[a,"key"])),value:i._parse(new it(n,t,n.path,[a,"value"]))})));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of a){const r=await n.key,i=await n.value;if("aborted"===r.status||"aborted"===i.status)return He;"dirty"!==r.status&&"dirty"!==i.status||t.dirty(),e.set(r.value,i.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of a){const r=n.key,i=n.value;if("aborted"===r.status||"aborted"===i.status)return He;"dirty"!==r.status&&"dirty"!==i.status||t.dirty(),e.set(r.value,i.value)}return{status:t.value,value:e}}}}Xt.create=(e,t,n)=>new Xt({valueType:t,keyType:e,typeName:xn.ZodMap,...st(n)});class Qt extends ot{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Me.set)return Ve(n,{code:Le.invalid_type,expected:Me.set,received:n.parsedType}),He;const r=this._def;null!==r.minSize&&n.data.size<r.minSize.value&&(Ve(n,{code:Le.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),null!==r.maxSize&&n.data.size>r.maxSize.value&&(Ve(n,{code:Le.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const i=this._def.valueType;function a(e){const n=new Set;for(const r of e){if("aborted"===r.status)return He;"dirty"===r.status&&t.dirty(),n.add(r.value)}return{status:t.value,value:n}}const s=[...n.data.values()].map(((e,t)=>i._parse(new it(n,e,n.path,t))));return n.common.async?Promise.all(s).then((e=>a(e))):a(s)}min(e,t){return new Qt({...this._def,minSize:{value:e,message:et.toString(t)}})}max(e,t){return new Qt({...this._def,maxSize:{value:e,message:et.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Qt.create=(e,t)=>new Qt({valueType:e,minSize:null,maxSize:null,typeName:xn.ZodSet,...st(t)});class en extends ot{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Me.function)return Ve(t,{code:Le.invalid_type,expected:Me.function,received:t.parsedType}),He;function n(e,n){return Je({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ue(),$e].filter((e=>!!e)),issueData:{code:Le.invalid_arguments,argumentsError:n}})}function r(e,n){return Je({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ue(),$e].filter((e=>!!e)),issueData:{code:Le.invalid_return_type,returnTypeError:n}})}const i={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof on){const e=this;return qe((async function(...t){const s=new Fe([]),o=await e._def.args.parseAsync(t,i).catch((e=>{throw s.addIssue(n(t,e)),s})),c=await Reflect.apply(a,this,o);return await e._def.returns._def.type.parseAsync(c,i).catch((e=>{throw s.addIssue(r(c,e)),s}))}))}{const e=this;return qe((function(...t){const s=e._def.args.safeParse(t,i);if(!s.success)throw new Fe([n(t,s.error)]);const o=Reflect.apply(a,this,s.data),c=e._def.returns.safeParse(o,i);if(!c.success)throw new Fe([r(o,c.error)]);return c.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new en({...this._def,args:Gt.create(e).rest($t.create())})}returns(e){return new en({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new en({args:e||Gt.create([]).rest($t.create()),returns:t||$t.create(),typeName:xn.ZodFunction,...st(n)})}}class tn extends ot{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}tn.create=(e,t)=>new tn({getter:e,typeName:xn.ZodLazy,...st(t)});class nn extends ot{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Ve(t,{received:t.data,code:Le.invalid_literal,expected:this._def.value}),He}return{status:"valid",value:e.data}}get value(){return this._def.value}}function rn(e,t){return new an({values:e,typeName:xn.ZodEnum,...st(t)})}nn.create=(e,t)=>new nn({value:e,typeName:xn.ZodLiteral,...st(t)});class an extends ot{constructor(){super(...arguments),nt.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return Ve(t,{expected:je.joinValues(n),received:t.parsedType,code:Le.invalid_type}),He}if(Xe(this,nt)||Qe(this,nt,new Set(this._def.values)),!Xe(this,nt).has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return Ve(t,{received:t.data,code:Le.invalid_enum_value,options:n}),He}return qe(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return an.create(e,{...this._def,...t})}exclude(e,t=this._def){return an.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}nt=new WeakMap,an.create=rn;class sn extends ot{constructor(){super(...arguments),rt.set(this,void 0)}_parse(e){const t=je.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==Me.string&&n.parsedType!==Me.number){const e=je.objectValues(t);return Ve(n,{expected:je.joinValues(e),received:n.parsedType,code:Le.invalid_type}),He}if(Xe(this,rt)||Qe(this,rt,new Set(je.getValidEnumValues(this._def.values))),!Xe(this,rt).has(e.data)){const e=je.objectValues(t);return Ve(n,{received:n.data,code:Le.invalid_enum_value,options:e}),He}return qe(e.data)}get enum(){return this._def.values}}rt=new WeakMap,sn.create=(e,t)=>new sn({values:e,typeName:xn.ZodNativeEnum,...st(t)});class on extends ot{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Me.promise&&!1===t.common.async)return Ve(t,{code:Le.invalid_type,expected:Me.promise,received:t.parsedType}),He;const n=t.parsedType===Me.promise?t.data:Promise.resolve(t.data);return qe(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}on.create=(e,t)=>new on({type:e,typeName:xn.ZodPromise,...st(t)});class cn extends ot{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===xn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,i={addIssue:e=>{Ve(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===r.type){const e=r.transform(n.data,i);if(n.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return He;const r=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===r.status?He:"dirty"===r.status||"dirty"===t.value?Be(r.value):r}));{if("aborted"===t.value)return He;const r=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===r.status?He:"dirty"===r.status||"dirty"===t.value?Be(r.value):r}}if("refinement"===r.type){const e=e=>{const t=r.refinement(e,i);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const r=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===r.status?He:("dirty"===r.status&&t.dirty(),e(r.value),{status:t.value,value:r.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?He:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===r.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ge(e))return e;const a=r.transform(e.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>Ge(e)?Promise.resolve(r.transform(e.value,i)).then((e=>({status:t.value,value:e}))):e))}je.assertNever(r)}}cn.create=(e,t,n)=>new cn({schema:e,typeName:xn.ZodEffects,effect:t,...st(n)}),cn.createWithPreprocess=(e,t,n)=>new cn({schema:t,effect:{type:"preprocess",transform:e},typeName:xn.ZodEffects,...st(n)});class un extends ot{_parse(e){return this._getType(e)===Me.undefined?qe(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}un.create=(e,t)=>new un({innerType:e,typeName:xn.ZodOptional,...st(t)});class ln extends ot{_parse(e){return this._getType(e)===Me.null?qe(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ln.create=(e,t)=>new ln({innerType:e,typeName:xn.ZodNullable,...st(t)});class dn extends ot{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===Me.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}dn.create=(e,t)=>new dn({innerType:e,typeName:xn.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...st(t)});class pn extends ot{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Ye(r)?r.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new Fe(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===r.status?r.value:this._def.catchValue({get error(){return new Fe(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}pn.create=(e,t)=>new pn({innerType:e,typeName:xn.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...st(t)});class hn extends ot{_parse(e){if(this._getType(e)!==Me.nan){const t=this._getOrReturnCtx(e);return Ve(t,{code:Le.invalid_type,expected:Me.nan,received:t.parsedType}),He}return{status:"valid",value:e.data}}}hn.create=e=>new hn({typeName:xn.ZodNaN,...st(e)});const fn=Symbol("zod_brand");class mn extends ot{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class gn extends ot{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?He:"dirty"===e.status?(t.dirty(),Be(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?He:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new gn({in:e,out:t,typeName:xn.ZodPipeline})}}class yn extends ot{_parse(e){const t=this._def.innerType._parse(e),n=e=>(Ge(e)&&(e.value=Object.freeze(e.value)),e);return Ye(t)?t.then((e=>n(e))):n(t)}unwrap(){return this._def.innerType}}function vn(e,t){const n="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof n?{message:n}:n}function _n(e,t={},n){return e?Ft.create().superRefine(((r,i)=>{var a,s;const o=e(r);if(o instanceof Promise)return o.then((e=>{var a,s;if(!e){const e=vn(t,r),o=null===(s=null!==(a=e.fatal)&&void 0!==a?a:n)||void 0===s||s;i.addIssue({code:"custom",...e,fatal:o})}}));if(!o){const e=vn(t,r),o=null===(s=null!==(a=e.fatal)&&void 0!==a?a:n)||void 0===s||s;i.addIssue({code:"custom",...e,fatal:o})}})):Ft.create()}yn.create=(e,t)=>new yn({innerType:e,typeName:xn.ZodReadonly,...st(t)});const bn={object:zt.lazycreate};var xn,wn;(wn=xn||(xn={})).ZodString="ZodString",wn.ZodNumber="ZodNumber",wn.ZodNaN="ZodNaN",wn.ZodBigInt="ZodBigInt",wn.ZodBoolean="ZodBoolean",wn.ZodDate="ZodDate",wn.ZodSymbol="ZodSymbol",wn.ZodUndefined="ZodUndefined",wn.ZodNull="ZodNull",wn.ZodAny="ZodAny",wn.ZodUnknown="ZodUnknown",wn.ZodNever="ZodNever",wn.ZodVoid="ZodVoid",wn.ZodArray="ZodArray",wn.ZodObject="ZodObject",wn.ZodUnion="ZodUnion",wn.ZodDiscriminatedUnion="ZodDiscriminatedUnion",wn.ZodIntersection="ZodIntersection",wn.ZodTuple="ZodTuple",wn.ZodRecord="ZodRecord",wn.ZodMap="ZodMap",wn.ZodSet="ZodSet",wn.ZodFunction="ZodFunction",wn.ZodLazy="ZodLazy",wn.ZodLiteral="ZodLiteral",wn.ZodEnum="ZodEnum",wn.ZodEffects="ZodEffects",wn.ZodNativeEnum="ZodNativeEnum",wn.ZodOptional="ZodOptional",wn.ZodNullable="ZodNullable",wn.ZodDefault="ZodDefault",wn.ZodCatch="ZodCatch",wn.ZodPromise="ZodPromise",wn.ZodBranded="ZodBranded",wn.ZodPipeline="ZodPipeline",wn.ZodReadonly="ZodReadonly";const kn=St.create,Cn=jt.create,Tn=hn.create,An=Ot.create,In=Zt.create,Nn=Rt.create,Sn=Mt.create,En=Pt.create,jn=Lt.create,On=Ft.create,Zn=$t.create,Rn=Dt.create,Mn=Ut.create,Pn=Jt.create,Ln=zt.create,Fn=zt.strictCreate,$n=Ht.create,Dn=qt.create,Un=Kt.create,Jn=Gt.create,Vn=Yt.create,zn=Xt.create,Hn=Qt.create,Bn=en.create,qn=tn.create,Wn=nn.create,Kn=an.create,Gn=sn.create,Yn=on.create,Xn=cn.create,Qn=un.create,er=ln.create,tr=cn.createWithPreprocess,nr=gn.create,rr={string:e=>St.create({...e,coerce:!0}),number:e=>jt.create({...e,coerce:!0}),boolean:e=>Zt.create({...e,coerce:!0}),bigint:e=>Ot.create({...e,coerce:!0}),date:e=>Rt.create({...e,coerce:!0})},ir=He;var ar=Object.freeze({__proto__:null,defaultErrorMap:$e,setErrorMap:function(e){De=e},getErrorMap:Ue,makeIssue:Je,EMPTY_PATH:[],addIssueToContext:Ve,ParseStatus:ze,INVALID:He,DIRTY:Be,OK:qe,isAborted:We,isDirty:Ke,isValid:Ge,isAsync:Ye,get util(){return je},get objectUtil(){return Ze},ZodParsedType:Me,getParsedType:Pe,ZodType:ot,datetimeRegex:At,ZodString:St,ZodNumber:jt,ZodBigInt:Ot,ZodBoolean:Zt,ZodDate:Rt,ZodSymbol:Mt,ZodUndefined:Pt,ZodNull:Lt,ZodAny:Ft,ZodUnknown:$t,ZodNever:Dt,ZodVoid:Ut,ZodArray:Jt,ZodObject:zt,ZodUnion:Ht,ZodDiscriminatedUnion:qt,ZodIntersection:Kt,ZodTuple:Gt,ZodRecord:Yt,ZodMap:Xt,ZodSet:Qt,ZodFunction:en,ZodLazy:tn,ZodLiteral:nn,ZodEnum:an,ZodNativeEnum:sn,ZodPromise:on,ZodEffects:cn,ZodTransformer:cn,ZodOptional:un,ZodNullable:ln,ZodDefault:dn,ZodCatch:pn,ZodNaN:hn,BRAND:fn,ZodBranded:mn,ZodPipeline:gn,ZodReadonly:yn,custom:_n,Schema:ot,ZodSchema:ot,late:bn,get ZodFirstPartyTypeKind(){return xn},coerce:rr,any:On,array:Pn,bigint:An,boolean:In,date:Nn,discriminatedUnion:Dn,effect:Xn,enum:Kn,function:Bn,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>_n((t=>t instanceof e),t),intersection:Un,lazy:qn,literal:Wn,map:zn,nan:Tn,nativeEnum:Gn,never:Rn,null:jn,nullable:er,number:Cn,object:Ln,oboolean:()=>In().optional(),onumber:()=>Cn().optional(),optional:Qn,ostring:()=>kn().optional(),pipeline:nr,preprocess:tr,promise:Yn,record:Vn,set:Hn,strictObject:Fn,string:kn,symbol:Sn,transformer:Xn,tuple:Jn,undefined:En,union:$n,unknown:Zn,void:Mn,NEVER:ir,ZodIssueCode:Le,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:Fe});const sr=/\{\{([\w\[\].'"\-]+)\}\}/g;function or(e,t){if("string"==typeof e)return function(e,t){return e.replace(sr,((e,n)=>{const[r,...i]=n.split(".");if("vars"===r||"steps"===r){const e=function(e,t){if(t&&null!=e)return(t.match(/(\w+|\[\d+\]|\[['"][^'"\]]+['"]\])/g)||[]).reduce(((e,t)=>{if(null!=e)return e[t.startsWith("[")?t.replace(/^\[['"]?|['"]?\]$/g,""):t]}),e)}(t[r],i.join("."));if(void 0!==e)return String(e)}return e}))}(e,t);if(Array.isArray(e))return e.map((e=>or(e,t)));if(e&&"object"==typeof e){const n={};for(const[r,i]of Object.entries(e))n[r]=or(i,t);return n}return e}const cr=ar.object({use:ar.string(),output:ar.string().optional()}).passthrough(),ur=ar.object({steps:ar.array(cr)}).passthrough();class lr{constructor(e,n={}){t(this,"vars"),t(this,"stepOutputs",new Map),t(this,"registry"),this.registry=e,this.vars=n}getPlaceholderContext(){const e={};for(const[t,n]of this.stepOutputs.entries())e[t]=n;return{vars:this.vars,steps:e}}async processYaml(e,t){const n=Re(t),i=ur.safeParse(n);if(!i.success)throw console.error("Invalid rule format",i.error.errors),new r("Invalid rule format","rules/invalid-format",{context:{errors:i.error.errors}});await this.processRule(e,i.data)}async processStep(e,t){const n=this.registry.get(t.use);if(!n)throw new r(`Tool ${t.use} not found`,"rules/tool-not-found",{context:{step:t}});const i=or(t,this.getPlaceholderContext());this.validateStepThrowIfInvalid(n,i);const{result:a,shouldContinue:s}=await n.execute(i,{jobId:e});return i.output&&this.stepOutputs.set(i.output,a),{result:a,shouldContinue:s}}async processRule(e,t){for(const n of t.steps){const{shouldContinue:t}=await this.processStep(e,n);if(!t)break}}validateStepThrowIfInvalid(e,t){e.validateParams(t)}getStepOutputs(){return this.stepOutputs}getStepOutputsAsJson(){const e={};return this.stepOutputs.forEach(((t,n)=>{e[n]=t})),e}}const dr=ar.object({xpath:ar.string().optional(),match:ar.string().optional(),is_positive:ar.boolean().optional().default(!0)}).refine((e=>!!e.xpath||!!e.match),{message:"Either 'xpath' or 'match' must be provided. If no 'xpath' is provided, 'match' is required.",path:["xpath","match"]}),pr=ar.array(dr).optional(),hr=ar.object({positive:ar.string().optional(),negative:ar.string().optional()}).optional(),fr=ar.object({xpath:ar.string(),timeout:ar.number().optional()}).optional(),mr={field_name:ar.string(),xpath:ar.string(),regexp:ar.string().optional(),template:ar.string().optional()},gr=ar.object({...mr,type:ar.literal(c.PROPERTY)}),yr=ar.object({...mr,type:ar.literal(c.PROPERTIES)}),vr=ar.object({...mr,type:ar.literal(c.JSON),path:ar.string().optional()}),_r=ar.lazy((()=>ar.discriminatedUnion("type",[gr,br,xr,yr,vr]))),br=ar.object({...mr,type:ar.literal(c.OBJECT),child:ar.array(_r)}),xr=ar.object({...mr,type:ar.literal(c.OBJECTS),child:ar.array(_r)}),wr=ar.object({html:ar.boolean().optional(),urls:ar.boolean().optional(),plaintext:ar.boolean().optional(),captcha:hr.optional(),captchas:pr.optional(),wait:fr.optional(),fields:ar.array(_r)}),kr=async()=>{try{await chrome.offscreen.hasDocument()||await chrome.offscreen.createDocument({url:"./src/pages/offscreen/index.html",reasons:[chrome.offscreen.Reason.DOM_SCRAPING,chrome.offscreen.Reason.BLOBS],justification:"Need to render pages for dynamic content scraping and keep background scripts running"})}catch(e){return console.log("Failed to create offscreen document:",e),Promise.reject(e)}},Cr=ar.object({use:ar.literal("fetch"),url:ar.string(),config:ar.object({method:ar.enum(["GET","POST","PUT","DELETE","HEAD"]).optional(),headers:ar.record(ar.string()).optional(),body:ar.string().optional(),removeHeaders:ar.array(ar.string()).default([]),includeResponseHeaders:ar.boolean().optional(),timeout:ar.coerce.number().optional(),responseType:ar.enum(["json","text","binary"]).optional()}).optional().default({})});class Tr{constructor(){t(this,"name","fetch")}validateParams(e){const t=Cr.safeParse(e);if(!t.success)throw new r("Invalid fetch params","rules/invalid-params",{context:{errors:t.error.errors}});return!0}async fetchWithTimeout(e,t){if(!t)return e;const n=new Promise(((e,n)=>{setTimeout((()=>{n(new u(`Request timed out after ${t}ms`))}),t)}));return Promise.race([e,n])}async fetchWithConfig(e,t){var n;const a={method:t.method||"GET",headers:new Headers(t.headers||{})};if(t.body&&(a.body=t.body),(null==(n=t.removeHeaders)?void 0:n.length)&&a.headers instanceof Headers)for(const r of t.removeHeaders)a.headers.delete(r);try{return await this.fetchWithTimeout(fetch(e,a),t.timeout)}catch(s){if(s instanceof r)throw s;throw new r(`Network error while fetching ${e}`,i.FETCH_NETWORK_ERROR,{cause:s instanceof Error?s:void 0,context:{url:e,method:a.method,originalError:s instanceof Error?s.message:String(s)}})}}getResponseHeaders(e){const t={};return e.headers.forEach(((e,n)=>{t[n]=e})),t}async processResponse(e,t,n=!1){const s={data:"",responseUrl:e.url};n&&(s.headers=this.getResponseHeaders(e));try{switch(t){case"binary":{const t=await e.arrayBuffer(),n=new Uint8Array(t);s.data=a.from(n).toString("base64");break}case"json":{const t=await e.json();s.data=JSON.stringify(t);break}default:s.data=await e.text()}return s}catch(o){throw new r("Failed to process response",i.FETCH_INVALID_RESPONSE,{cause:o instanceof Error?o:void 0,context:{responseType:t,contentType:e.headers.get("content-type"),originalError:o instanceof Error?o.message:String(o)}})}}async executeFetch(e){var t,n,a,s,o,c,u;if(!e.url)throw new r("URL is required for fetch-based jobs",i.FETCH_MISSING_URL);const l={method:(null==(t=e.config)?void 0:t.method)||"GET",headers:(null==(n=e.config)?void 0:n.headers)||{},responseType:(null==(a=e.config)?void 0:a.responseType)||"text",removeHeaders:(null==(s=e.config)?void 0:s.removeHeaders)||[],includeResponseHeaders:Boolean(null==(o=e.config)?void 0:o.includeResponseHeaders),timeout:null==(c=e.config)?void 0:c.timeout};(null==(u=e.config)?void 0:u.body)&&(l.body=e.config.body);const d=await this.fetchWithConfig(e.url,l);if(!d.ok){const t=await d.text();throw new r(`HTTP error! status: ${d.status}`,i.FETCH_HTTP_ERROR,{context:{status:d.status,statusText:d.statusText,url:e.url,method:l.method,html:t}})}return this.processResponse(d,l.responseType||"text",l.includeResponseHeaders)}handleExecutionError(e,t,n="FETCH_NETWORK_ERROR"){return e instanceof r?e:new r(e instanceof Error?e.message:"Unknown error occurred",i[n],{cause:e instanceof Error?e:void 0,context:{url:t.url}})}async execute(e,t){try{return{result:await this.executeFetch(e),shouldContinue:!0}}catch(n){throw this.handleExecutionError(n,e)}}}const Ar=Cr.extend({use:ar.literal("fetch-and-extract"),rules:wr});class Ir{constructor(){t(this,"name","fetch-and-extract"),t(this,"fetchTool"),this.fetchTool=new Tr}validateParams(e){const t=Ar.safeParse(e);if(!t.success)throw new r("Invalid fetch and extract params","rules/invalid-params",{context:{errors:t.error.errors}});return!0}async execute(e,t){try{const{result:n}=await this.fetchTool.execute({...e,use:"fetch"},t),r=n.data,i=n.responseUrl||e.url;await kr();const{result:a}=await s.sendMessageWithResponse("offscreen.parseHtml",{html:r,baseUrl:i,rules:e.rules});return{result:a,shouldContinue:!0}}catch(n){if(n instanceof r)throw n;throw new r(n instanceof Error?n.message:"Unknown error occurred",i.FETCH_HTML_PARSE_ERROR,{cause:n instanceof Error?n:void 0,context:{url:e.url}})}}}const Nr=ar.object({use:ar.literal("offscreen"),url:ar.string(),timeout:ar.coerce.number().optional(),rules:wr});class Sr{constructor(){t(this,"name","offscreen")}validateParams(e){const t=Nr.safeParse(e);if(!t.success)throw new r("Invalid offscreen params","rules/invalid-params",{context:{errors:t.error.errors}});return!0}async execute(e,t){try{await kr();const n=Math.random().toString(36).substring(2,10),{result:r}=await s.sendMessageWithResponse("offscreen.extractData",{executionId:n,jobId:t.jobId,params:e});return{result:r,shouldContinue:!0}}catch(n){if(n instanceof r)throw n;throw new r(n instanceof Error?n.message:"Unknown error occurred","offscreen/extract-error",{cause:n instanceof Error?n:void 0,context:{url:e.url,jobId:t.jobId}})}}}const Er="EQUALS",jr="NOT_EQUALS",Or="CONTAINS",Zr="NOT_CONTAINS",Rr="GREATER_THAN",Mr="LESS_THAN",Pr="MATCHES_PATTERN",Lr=ar.enum([Er,jr,Or,Zr,Rr,Mr,Pr]),Fr=ar.object({use:ar.literal("conditional-gate"),rule:ar.object({value:ar.union([ar.string(),ar.number(),ar.boolean()]),operator:Lr,expected:ar.union([ar.string(),ar.number(),ar.boolean()]),options:ar.object({errorMessage:ar.string().optional(),caseSensitive:ar.boolean().default(!0).optional(),customErrorCode:ar.string().optional(),throwError:ar.boolean().default(!0).optional()}).default({}).optional()})});class $r{constructor(){t(this,"name","conditional-gate"),t(this,"regexCache",new Map)}validateParams(e){const t=Fr.safeParse(e);if(!t.success)throw new r("Invalid validation parameters","rules/invalid-params",{context:{errors:t.error.errors}});return!0}getOperatorLabel(e){return{EQUALS:"does not equal",NOT_EQUALS:"equals",CONTAINS:"does not contain",NOT_CONTAINS:"contains",GREATER_THAN:"is not greater than",LESS_THAN:"is not less than",MATCHES_PATTERN:"does not match pattern"}[e]}getValidationFailureDetails(e,t,n,r){const i="string"==typeof e?`"${e}"`:String(e),a="string"==typeof n?`"${n}"`:String(n);let s=`Validation failed: ${i} ${this.getOperatorLabel(t)} ${a}`;switch((null==r?void 0:r.wasCoerced)&&(s+=`\nType coercion occurred: ${r.from} â†’ ${r.to}`),t){case Er:case jr:typeof e!=typeof n&&(s+=`\nType mismatch: '${typeof e}' vs '${typeof n}'`);break;case Or:case Zr:"string"!=typeof e&&(s+=`\nValue type '${typeof e}' is not a string`),"string"!=typeof n&&(s+=`\nExpected value type '${typeof n}' is not a string`);break;case Rr:case Mr:{const t=Number(e),r=Number(n);Number.isFinite(t)||(s+=`\nValue '${e}' cannot be converted to a number`),Number.isFinite(r)||(s+=`\nExpected value '${n}' cannot be converted to a number`);break}case Pr:"string"!=typeof e&&(s+=`\nValue type '${typeof e}' is not a string`);try{new RegExp(String(n))}catch(o){s+=`\nInvalid regex pattern: ${o instanceof Error?o.message:String(o)}`}}return s}getOrCreateRegex(e,t){const n=`${e}:${t}`;let r=this.regexCache.get(n);return r||(r=new RegExp(e,t?void 0:"i"),this.regexCache.set(n,r)),r}validateEquals({value:e,expected:t,caseSensitive:n}){return"string"!=typeof e||"string"!=typeof t||n?typeof e==typeof t?{isValid:e===t,typeCoercion:void 0}:{isValid:this.compareStr(String(e),String(t),n),typeCoercion:{wasCoerced:!0,from:`${typeof e}/${typeof t}`,to:"string"}}:{isValid:e.toLowerCase()===t.toLowerCase(),typeCoercion:void 0}}validateNotEquals(e){const t=this.validateEquals(e);return{...t,isValid:!t.isValid}}validateContains({value:e,expected:t,caseSensitive:n}){const r="string"==typeof e?e:String(e),i="string"==typeof t?t:String(t),a="string"!=typeof e||"string"!=typeof t?{wasCoerced:!0,from:`${typeof e}/${typeof t}`,to:"string"}:void 0;if(!n){const e=r.toLowerCase(),t=i.toLowerCase();return{isValid:e.includes(t),typeCoercion:a}}return{isValid:r.includes(i),typeCoercion:a}}validateNotContains(e){const t=this.validateContains(e);return{...t,isValid:!t.isValid}}validateNumericComparison({value:e,expected:t},n){const r="number"!=typeof e||"number"!=typeof t?{wasCoerced:!0,from:`${typeof e}/${typeof t}`,to:"number"}:void 0;return{isValid:n(Number(e),Number(t)),typeCoercion:r}}compareStr(e,t,n){return n?e===t:e.toLowerCase()===t.toLowerCase()}evaluateRule(e){const{value:t,operator:n,expected:a,options:s={}}=e,{caseSensitive:o=!0}=s,c={value:t,expected:a,caseSensitive:o};switch(n){case Er:return this.validateEquals(c);case jr:return this.validateNotEquals(c);case Or:return this.validateContains(c);case Zr:return this.validateNotContains(c);case Rr:return this.validateNumericComparison(c,((e,t)=>e>t));case Mr:return this.validateNumericComparison(c,((e,t)=>e<t));case Pr:{const e="string"!=typeof t?{wasCoerced:!0,from:typeof t,to:"string"}:void 0;try{return{isValid:this.getOrCreateRegex(String(a),o).test("string"==typeof t?t:String(t)),typeCoercion:e}}catch(u){throw new r("Invalid regex pattern",i.CONDITIONAL_INVALID_REGEX,{context:{pattern:String(a)}})}}default:throw new r("Unsupported operator",i.CONDITIONAL_UNSUPPORTED_TYPE,{context:{operator:n}})}}validateInput(e,t,n){if(n===Rr||n===Mr){const a=Number(e),s=Number(t);if(!Number.isFinite(a)||!Number.isFinite(s))throw new r("Invalid numeric values for comparison",i.CONDITIONAL_INVALID_REGEX,{context:{value:e,expected:t,operator:n,actualType:typeof e,expectedType:typeof t}})}if(n===Pr&&"string"!=typeof t)throw new r("Pattern must be a string for MATCHES_PATTERN operator",i.CONDITIONAL_INVALID_REGEX,{context:{expected:t,type:typeof t}})}async execute(e,t){var n,a,s;try{this.validateInput(e.rule.value,e.rule.expected,e.rule.operator);const{isValid:o,typeCoercion:c}=this.evaluateRule(e.rule),u=(null==(n=e.rule.options)?void 0:n.throwError)??!0;if(!o){const n=this.getValidationFailureDetails(e.rule.value,e.rule.operator,e.rule.expected,c);if(u)throw new r((null==(a=e.rule.options)?void 0:a.errorMessage)||n,(null==(s=e.rule.options)?void 0:s.customErrorCode)||i.CONDITIONAL_FAILED,{context:{rule:e.rule,failureDetails:n,jobId:t.jobId}});return{result:{isValid:o,actual:e.rule.value,expected:e.rule.expected},shouldContinue:!1}}return{result:{isValid:o,actual:e.rule.value,expected:e.rule.expected},shouldContinue:!0}}catch(o){if(o instanceof r)throw o;throw new r("Validation failed",i.CONDITIONAL_EVALUATION_ERROR,{cause:o instanceof Error?o:void 0,context:{rule:e.rule,jobId:t.jobId}})}}clearRegexCache(){this.regexCache.clear()}}class Dr{constructor(){t(this,"tools",new Map)}register(e){this.tools.set(e.name,e)}get(e){return this.tools.get(e)}list(){return Array.from(this.tools.values())}}const Ur=new class{initialize(){}},Jr=15,Vr=0,zr=async()=>{const{jobExecutionDelay:e,reloadExtensionAfterJobs:t}=await l(["jobExecutionDelay","reloadExtensionAfterJobs"]),n=await(async()=>{try{return await p.getConfiguration()}catch(e){return h.error("Failed to fetch configuration",{error:e}),null}})(),r=(null==n?void 0:n.job_execution_delay)??e??Jr,i=(null==n?void 0:n.reload_extension_after_jobs)??t??Vr,a={};return r!==e&&(a.jobExecutionDelay=r),i!==t&&(a.reloadExtensionAfterJobs=Number(i)),Object.keys(a).length>0&&await d(a),{jobExecutionDelay:r,reloadExtensionAfterJobs:Number(i)}},Hr=class e{constructor(){t(this,"isInitialized",!1),t(this,"samplingTimers",new Map),t(this,"cpuInfoHistory",[]),t(this,"activeJobs",new Map),this.samplingTimers=new Map,this.activeJobs=new Map}init(){this.isInitialized||(this.isInitialized=!0,chrome.system.cpu.getInfo().then((e=>{this.updateCpuUsageHistory(e.processors.map((e=>e.usage)))})),this.listenPerformanceSampleMessage())}updateCpuUsageHistory(t){this.cpuInfoHistory.push({timestamp:Date.now(),usage:t}),this.cpuInfoHistory.length>e.MAX_HISTORY_LENGTH&&this.cpuInfoHistory.shift()}listenPerformanceSampleMessage(){s.handleMessage("performance.sample",((e,t)=>{this.addSample(e.jobId,e.label)}),!1)}async getSystemMetrics(){const[e,t]=await Promise.all([chrome.system.cpu.getInfo(),chrome.system.memory.getInfo()]),n=this.calculateCpuPercentageLoad(e.processors.map((e=>e.usage)));return{cpu:{usage:e.processors.map((e=>e.usage)),averageUsagePercentage:n},memory:{availableCapacity:t.availableCapacity,capacity:t.capacity,usedPercentage:(t.capacity-t.availableCapacity)/t.capacity*100},timestamp:Date.now()}}calculateCpuPercentageLoad(e){if(0===this.cpuInfoHistory.length)return this.updateCpuUsageHistory(e),0;const t=t=>e.map(((e,n)=>{const r=t[n],i=e.user-r.user,a=e.kernel-r.kernel,s=e.total-r.total;return 0===s?0:(i+a)/s*100})).reduce(((e,t)=>e+t),0)/e.length;let n=0;for(let r=this.cpuInfoHistory.length-1;r>=0&&(n=t(this.cpuInfoHistory[r].usage),0===n);r--);return this.updateCpuUsageHistory(e),n}async startMeasuring(t,n){try{const r=await this.getSystemMetrics();this.activeJobs.set(t,{startTime:performance.now(),url:n,startMetrics:r,measurements:new Map});const i=setInterval((async()=>{await this.addSample(t)}),e.SAMPLING_INTERVAL);this.samplingTimers.set(t,i)}catch(r){h.error("Failed to start performance monitoring:",{error:r})}}calculateMetricsStatistics(e){if(0===e.size)return{cpu:{min:0,max:0,avg:0},memory:{min:0,max:0,avg:0}};let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,r=0,i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=0;for(const{metrics:c}of e.values()){const e=c.cpu.averageUsagePercentage,o=c.memory.usedPercentage;t=Math.min(t,e),n=Math.max(n,e),r+=e,i=Math.min(i,o),a=Math.max(a,o),s+=o}const o=e.size;return{cpu:{min:Number(t.toFixed(2)),max:Number(n.toFixed(2)),avg:Number((r/o).toFixed(2))},memory:{min:Number(i.toFixed(2)),max:Number(a.toFixed(2)),avg:Number((s/o).toFixed(2))}}}async stopMeasuring(e){const t=this.activeJobs.get(e);if(!t)return h.warn("No start metrics found for job",{jobId:e}),null;try{this.stopSampling(e);const n=performance.now(),r=await this.getSystemMetrics(),i={};t.measurements.forEach(((e,t)=>{i[t]=e}));const a=this.calculateMetricsStatistics(t.measurements),s={jobId:e,duration:n-t.startTime,statistics:a,metrics:{start:{cpu:Number(t.startMetrics.cpu.averageUsagePercentage.toFixed(2)),memory:Number(t.startMetrics.memory.usedPercentage.toFixed(2))},end:{cpu:Number(r.cpu.averageUsagePercentage.toFixed(2)),memory:Number(r.memory.usedPercentage.toFixed(2))}}};return this.activeJobs.delete(e),s}catch(n){return h.error("Failed to stop performance monitoring:",{error:n}),null}}async getMetricsSnapshot(){return this.getSystemMetrics()}stopSampling(e){const t=this.samplingTimers.get(e);t&&(clearInterval(t),this.samplingTimers.delete(e))}async addSample(e,t){try{const n=await this.getSystemMetrics(),r=this.activeJobs.get(e);r?r.measurements.set(`${t||"sample"}_${Date.now()}`,{timestamp:performance.now(),metrics:n}):h.warn("Cannot add sample: No active job found",{jobId:e})}catch(n){h.error("Failed to add performance sample:",{error:n,jobId:e})}}};t(Hr,"SAMPLING_INTERVAL",2e3),t(Hr,"MAX_HISTORY_LENGTH",2);const Br=new Hr;class qr{constructor(e,n={}){t(this,"config"),t(this,"state"),t(this,"jobTimer"),t(this,"pingTimer"),t(this,"currentJob"),t(this,"stateChangeCallbacks"),t(this,"currentJobInterval"),t(this,"processedJobsCount",0),t(this,"toolRegistry"),this.apiClient=e,this.config={jobInterval:n.jobInterval??5,pingInterval:n.pingInterval??12e4,reloadAfterJobs:n.reloadAfterJobs??0},this.currentJobInterval=this.config.jobInterval,this.state="IDLE",this.stateChangeCallbacks=new Set,this.setupStorageListeners(),this.toolRegistry=function(){const e=new Dr;return e.register(new Tr),e.register(new Ir),e.register(new Sr),e.register(new $r),e}(),Br.init()}setupStorageListeners(){chrome.storage.onChanged.addListener(this.handleStorageChanges.bind(this))}onStateChange(e){return this.stateChangeCallbacks.add(e),()=>this.stateChangeCallbacks.delete(e)}setState(e){if(this.state!==e){this.state=e;for(const t of this.stateChangeCallbacks)t(e);h.info(`JobManager state changed to ${e}`)}}async loadConfigFromStore(){const e=await zr();this.config.jobInterval=e.jobExecutionDelay,this.currentJobInterval=e.jobExecutionDelay,this.config.reloadAfterJobs=Number(e.reloadExtensionAfterJobs),h.info(`Initialized job interval: ${e.jobExecutionDelay}s, reloadAfterJobs: ${e.reloadExtensionAfterJobs}`)}async start(){if("RUNNING"===this.state)return void h.warn("JobManager is already running");await this.loadConfigFromStore();const{isOk:e,reason:t}=await this.verifyPreconditions();if(!e)return h.error("JobManager failed to start:",{reason:t}),void this.setState("ERROR");this.setState("RUNNING"),this.scheduleNextJob(),this.startPingScheduler()}async stop(){this.clearTimers(),this.setState("IDLE")}async pause(){this.setState("PAUSED"),this.clearTimers()}clearTimers(){this.jobTimer&&(clearTimeout(this.jobTimer),this.jobTimer=void 0),this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=void 0)}scheduleNextJob(){this.jobTimer&&clearTimeout(this.jobTimer),this.currentJobInterval&&(this.jobTimer=setTimeout((()=>this.executeJobCycle()),1e3*this.currentJobInterval))}async executeJobCycle(){"RUNNING"===this.state&&(this.currentJob?this.scheduleNextJob():this.currentJob=this.processJob().finally((()=>{this.currentJob=void 0})))}async processJob(){const{isOk:e}=await this.verifyPreconditions();if(!e)return;const t=await this.fetchJob();if(this.scheduleNextJob(),t)try{await Br.startMeasuring(t.id,t.url);const e=new lr(this.toolRegistry,t.vars);await e.processYaml(t.id,t.ruleCollection.yamlRules);const n=e.getStepOutputsAsJson(),r=await Br.stopMeasuring(t.id);await this.handleJobCompletion(t.id,n,{perfMetrics:r})}catch(n){const e=await Br.stopMeasuring(t.id);await this.handleJobError(t.id,n,{perfMetrics:e})}}async fetchJob(){try{return await this.apiClient.getJob()}catch(e){return h.error("Failed to fetch job:",{error:e}),null}}async handleJobCompletion(e,t,n){try{await this.apiClient.completeJob(e,t,n),h.info(`Job ${e} completed successfully`),this.processedJobsCount++,this.config.reloadAfterJobs&&this.processedJobsCount>=this.config.reloadAfterJobs&&(h.info(`Processed ${this.processedJobsCount} jobs, reloading extension...`),this.processedJobsCount=0,chrome.runtime.reload())}catch(r){h.error(`Failed to report job completion for ${e}:`,{error:r})}}async handleJobError(e,t,n){try{const i=t instanceof r?t.code??"UNKNOWN":"UNKNOWN",a=o(t),s={context:t instanceof r?t.toJSON():t,...n};a&&(s.html=a),await this.apiClient.reportError(e,i,s)}catch(i){h.error(`Failed to report error for job ${e}:`,{error:i})}}async verifyPreconditions(){const{isConnected:e,jwt:t,isActivated:n}=await l(["isConnected","jwt","isActivated"]),r=[];e||r.push("network connectivity"),t||r.push("authentication"),n||r.push("account activation");const i=0===r.length;return{isOk:i,reason:i?void 0:`Missing ${r.join(", ")}`}}async handleStorageChanges(e){if(!["jwt","isConnected","isActivated","jobInterval","reloadExtensionAfterJobs"].some((t=>t in e)))return;if("jobInterval"in e){const t=e.jobInterval.newValue;t!==this.currentJobInterval&&(this.currentJobInterval=t,"RUNNING"===this.state&&this.restartJobScheduler())}if("reloadExtensionAfterJobs"in e){const t=e.reloadExtensionAfterJobs.newValue;t!==this.config.reloadAfterJobs&&(this.config.reloadAfterJobs=t)}const{isOk:t,reason:n}=await this.verifyPreconditions();t&&"RUNNING"!==this.state?await this.start():t||"RUNNING"!==this.state||(h.warn("JobManager stopped due to missing preconditions:",{reason:n}),await this.stop())}restartJobScheduler(){this.jobTimer&&clearTimeout(this.jobTimer),this.scheduleNextJob()}startPingScheduler(){this.pingTimer&&clearInterval(this.pingTimer),this.pingTimer=setInterval((async()=>{const{isOk:e}=await this.verifyPreconditions();e&&await this.apiClient.ping().catch((e=>h.error("Ping failed:",{error:e})))}),this.config.pingInterval)}}const Wr=n();try{chrome.runtime.onStartup.addListener(kr),self.onmessage=e=>{},Ur.initialize();const e=new qr(p);kr().then((()=>{zr(),setInterval(zr,6e5),e.start()})),s.handleMessage("jobManagerStart",(async(t,n)=>{try{return await e.start(),!0}catch(r){return!1}})),s.handleMessage("jobManagerStop",(async(t,n)=>{try{return await e.stop(),!0}catch(r){return!1}})),chrome.runtime.onInstalled.addListener((()=>{l(["deviceId"]).then((({deviceId:e})=>{if(!e){const e=crypto.randomUUID();d({deviceId:e})}})).catch(Wr.captureException)})),chrome.runtime.onMessageExternal.addListener(((e,t,n)=>{switch(e.action){case"login":return e.email&&e.jwt&&d({email:e.email,jwt:e.jwt,isConnected:!0}).then((()=>{p.getWorker(),n({success:!0})})).catch((e=>{h.error("Failed to set app store",{error:e}),n({success:!1})})),!0;case"logout":return d({email:"",jwt:"",isConnected:!1}).then((()=>{n({success:!0})})).catch((e=>{h.error("Failed to set app store",{error:e}),n({success:!1})})),!0;case"isLoggedIn":return chrome.storage.local.get(["jwt"],(({jwt:e})=>n(!!e))),!0}})),chrome.runtime.onUpdateAvailable.addListener((e=>{h.info(`Updating to version ${e.version}...`),chrome.runtime.reload()}))}catch(Kr){Wr.captureException(Kr)}
